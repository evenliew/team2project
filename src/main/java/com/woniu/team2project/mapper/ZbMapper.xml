<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.woniu.team2project.mapper.ZbMapper">
	<!-- 添加专报 -->
	<insert id="insertZb">
		insert into 
			tb_zb 
		values (#{zb_id},
				#{zb_sb_time},
				#{zb_content},
				#{zb_state.zb_state_id},
				#{zb_remark},
				#{zb_founder.user_id},
				#{zb_recender.user_id},
				#{zb_ps_time},
				#{zb_sx.sx_id});
	</insert>
	<!-- 查询专报 -->
	<select id="selectZbByZb_id" resultMap="Zb_Mapper">
		select * from tb_zb where zb_id=#{zb_id};
	</select> 
	<resultMap type="Zb" id="Zb_Mapper">
		<association property="zb_state" column="zb_state_id" javaType="Zb_state" select="selectZb_stateById"/>
		<association property="zb_founder" column="zb_founder_id" javaType="User" select="selectFounderById"/>
		<association property="zb_recender" column="zb_recender_id" javaType="User" select="selectRecenderById"/>
		<association property="zb_sx" column="zb_sx_id" javaType="Sx" select="selectSxById"/>
	</resultMap>
	
	<!-- 查询专报状态 -->
	<select id="selectZb_stateById" resultType="Zb_state">
		select * from tb_zb_state where zb_state_id = #{zb_state_id}
	</select>
	<!--查询专报发布人  -->
	<select id="selectFounderById" resultType="User">
		select * from tb_user where user_id = #{zb_founder_id}
	</select>
	<!-- 查询专报接收人 -->
	<select id="selectRecenderById" resultType="User">
		select * from tb_user where user_id = #{zb_recender_id}
	</select>
	<!-- 查询专报事务 -->
	<select id="selectSxById" resultType="Sx">
		select * from tb_sx where sx_id = #{zb_sx_id}
	</select>
	<!-- 修改专报的状态 -->
	<update id="updateZb_state">
		update tb_zb set zb_state_id=#{zb_state_id} where zb_id=#{zb_id};
	</update>
	<!-- 查询所有专报 -->
	<select id="selectAllZb" resultMap="Zb_Mapper">
		select * from tb_zb
	</select>
</mapper>